{% extends 'base.html.twig' %}

{% block title %}{{ room.name }}{% endblock %}

{% block body %}
    <div class="page-header">
        <h1>ğŸ  {{ room.name }}</h1>
        <div style="display:flex; gap:0.5rem;">
            <a href="{{ path('app_room_index') }}" class="btn">â† Retour</a>
            {% if is_granted('ROLE_ADMIN') %}
                <a href="{{ path('app_room_edit', {'id': room.id}) }}" class="btn">âœï¸ Modifier</a>
            {% endif %}
        </div>
    </div>

    <div class="card" style="margin-bottom:1.5rem;">
        <p><strong>CapacitÃ© :</strong> {{ room.capacity }} personnes</p>
        <p><strong>Description :</strong> {{ room.description ?? 'Aucune description' }}</p>
        <p><strong>Statut :</strong> {{ room.isActive ? 'ğŸŸ¢ Disponible' : 'ğŸ”´ Indisponible' }}</p>

        {% if room.equipments|length > 0 %}
            <p><strong>Ã‰quipements :</strong>
                {% for equipment in room.equipments %}
                    <span style="background:#eff6ff; color:#2563eb; padding:0.2rem 0.6rem; border-radius:4px; font-size:0.8rem; margin-right:0.3rem;">
                        {{ equipment.name }}
                    </span>
                {% endfor %}
            </p>
        {% endif %}
    </div>

    <h2 style="margin-bottom:1rem;">ğŸ“… RÃ©servations Ã  venir</h2>

    {% if reservations|length > 0 %}
        <table>
            <thead>
                <tr>
                    <th>DÃ©but</th>
                    <th>Fin</th>
                    <th>RÃ©servÃ© par</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in reservations %}
                    <tr>
                        <td>{{ reservation.startDatetime|date('d/m/Y H:i') }}</td>
                        <td>{{ reservation.endDatetime|date('d/m/Y H:i') }}</td>
                        <td>{{ reservation.owner.firstName }} {{ reservation.owner.lastName }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p style="color:#16a34a; margin-bottom:1.5rem;">âœ… Aucune rÃ©servation Ã  venir â€” salle disponible !</p>
    {% endif %}

    <div style="display:flex; gap:1rem; margin-top:1.5rem;">
        <a href="{{ path('app_reservation_new') }}" class="btn btn-primary">ğŸ“… RÃ©server cette salle</a>

        {% if is_granted('ROLE_ADMIN') %}
            <form method="post" action="{{ path('app_room_delete', {'id': room.id}) }}"
                  data-confirm="ÃŠtes-vous sÃ»r de vouloir supprimer la salle {{ room.name }} ?">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ room.id) }}">
                <button type="submit" class="btn btn-danger">ğŸ—‘ Supprimer</button>
            </form>
        {% endif %}
    </div>
{% endblock %}