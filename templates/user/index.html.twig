{% extends 'base.html.twig' %}
{% block title %}Gestion des utilisateurs{% endblock %}
{% block body %}

    <div class="page-header">
        <h1>ðŸ‘¥ Utilisateurs</h1>
        <a href="{{ path('app_user_new') }}" class="btn btn-primary">+ Nouvel utilisateur</a>
    </div>

    <input type="text" id="table-search"
           placeholder="ðŸ” Rechercher un utilisateur..."
           style="margin-bottom:1.5rem; max-width:400px;">

    <table>
        <thead>
            <tr>
                <th>Nom</th>
                <th>Email</th>
                <th>RÃ´le</th>
                <th>Promotion</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for user in users %}
            <tr>
                <td>{{ user.firstName }} {{ user.lastName }}</td>
                <td>{{ user.email }}</td>
                <td>
                    {% if 'ROLE_ADMIN' in user.roles %}
                        <span style="background:#7c3aed; color:white; padding:0.2rem 0.6rem; border-radius:4px; font-size:0.75rem;">Admin</span>
                    {% elseif 'ROLE_COORDINATOR' in user.roles %}
                        <span style="background:#2563eb; color:white; padding:0.2rem 0.6rem; border-radius:4px; font-size:0.75rem;">Coordinateur</span>
                    {% else %}
                        <span style="background:#64748b; color:white; padding:0.2rem 0.6rem; border-radius:4px; font-size:0.75rem;">Ã‰tudiant</span>
                    {% endif %}
                </td>
                <td>{{ user.promotion ? user.promotion.name : 'â€”' }}</td>
                <td style="display:flex; gap:0.5rem;">
                    <a href="{{ path('app_user_show', {'id': user.id}) }}" class="btn">Voir</a>
                    <a href="{{ path('app_user_edit', {'id': user.id}) }}" class="btn">Modifier</a>
                    <a href="{{ path('app_user_reset_password', {'id': user.id}) }}" class="btn">ðŸ”‘ MDP</a>
                    <form method="post" action="{{ path('app_user_delete', {'id': user.id}) }}"
                          data-confirm="Supprimer {{ user.firstName }} {{ user.lastName }} ?">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
                        <button type="submit" class="btn btn-danger">ðŸ—‘</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% endblock %}